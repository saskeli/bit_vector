<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bit vector: bv::branchless_scan&lt; dtype, branches &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bit vector
   &#160;<span id="projectnumber">0.9</span>
   </div>
   <div id="projectbrief">Fast and space efficient dynamic bit vector library.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>bv</b></li><li class="navelem"><a class="el" href="classbv_1_1branchless__scan.html">branchless_scan</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classbv_1_1branchless__scan-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">bv::branchless_scan&lt; dtype, branches &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class providing support for cumulative sums.  
 <a href="classbv_1_1branchless__scan.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="branch__selection_8hpp_source.html">branch_selection.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:affab69f8448e7f3b1b064134c1af7247"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#affab69f8448e7f3b1b064134c1af7247">branchless_scan</a> ()</td></tr>
<tr class="separator:affab69f8448e7f3b1b064134c1af7247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a563dc71ab583876c649b3cf885267d6c"><td class="memItemLeft" align="right" valign="top">dtype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#a563dc71ab583876c649b3cf885267d6c">get</a> (uint8_t index) const</td></tr>
<tr class="memdesc:a563dc71ab583876c649b3cf885267d6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the cumulative sum at <code>index</code>.  <a href="classbv_1_1branchless__scan.html#a563dc71ab583876c649b3cf885267d6c">More...</a><br /></td></tr>
<tr class="separator:a563dc71ab583876c649b3cf885267d6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab90a25b40c679751d980447f69250bb9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#ab90a25b40c679751d980447f69250bb9">set</a> (uint8_t index, dtype value)</td></tr>
<tr class="memdesc:ab90a25b40c679751d980447f69250bb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the value at <code>index</code> to <code>value</code>.  <a href="classbv_1_1branchless__scan.html#ab90a25b40c679751d980447f69250bb9">More...</a><br /></td></tr>
<tr class="separator:ab90a25b40c679751d980447f69250bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13e33906ab251c2664755eb0bf084c20"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a13e33906ab251c2664755eb0bf084c20"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#a13e33906ab251c2664755eb0bf084c20">increment</a> (uint8_t from, uint8_t array_size, T change)</td></tr>
<tr class="memdesc:a13e33906ab251c2664755eb0bf084c20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increments all values in \([\mathrm{from}, \mathrm{array\_size})\) range.  <a href="classbv_1_1branchless__scan.html#a13e33906ab251c2664755eb0bf084c20">More...</a><br /></td></tr>
<tr class="separator:a13e33906ab251c2664755eb0bf084c20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2356610cf8948bbf29fa486264432f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#ab2356610cf8948bbf29fa486264432f6">insert</a> (uint8_t index, uint8_t array_size, dtype a_value, dtype b_value)</td></tr>
<tr class="memdesc:ab2356610cf8948bbf29fa486264432f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts a new value into the cumulative sums.  <a href="classbv_1_1branchless__scan.html#ab2356610cf8948bbf29fa486264432f6">More...</a><br /></td></tr>
<tr class="separator:ab2356610cf8948bbf29fa486264432f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4df7fdfe653f38675f6fbe016bec8ef1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#a4df7fdfe653f38675f6fbe016bec8ef1">remove</a> (uint8_t index, uint8_t array_size)</td></tr>
<tr class="memdesc:a4df7fdfe653f38675f6fbe016bec8ef1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes a value from the cumulative sums.  <a href="classbv_1_1branchless__scan.html#a4df7fdfe653f38675f6fbe016bec8ef1">More...</a><br /></td></tr>
<tr class="separator:a4df7fdfe653f38675f6fbe016bec8ef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d7cf39738cd42dceb5ef32feaa638d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#a7d7cf39738cd42dceb5ef32feaa638d5">clear_first</a> (uint8_t n, uint8_t array_size)</td></tr>
<tr class="memdesc:a7d7cf39738cd42dceb5ef32feaa638d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the first <code>n</code> elements from the structure.  <a href="classbv_1_1branchless__scan.html#a7d7cf39738cd42dceb5ef32feaa638d5">More...</a><br /></td></tr>
<tr class="separator:a7d7cf39738cd42dceb5ef32feaa638d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc501318e710b909b638636e117854f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#abc501318e710b909b638636e117854f9">clear_last</a> (uint8_t n, uint8_t array_size)</td></tr>
<tr class="memdesc:abc501318e710b909b638636e117854f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the last <code>n</code> elements from the structure.  <a href="classbv_1_1branchless__scan.html#abc501318e710b909b638636e117854f9">More...</a><br /></td></tr>
<tr class="separator:abc501318e710b909b638636e117854f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc082a7212f9f61122a66418d18a6156"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#adc082a7212f9f61122a66418d18a6156">append</a> (uint8_t n_elems, uint8_t array_size, <a class="el" href="classbv_1_1branchless__scan.html">branchless_scan</a> *other)</td></tr>
<tr class="memdesc:adc082a7212f9f61122a66418d18a6156"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds elements from <code>other</code> to the end of <code>this</code>  <a href="classbv_1_1branchless__scan.html#adc082a7212f9f61122a66418d18a6156">More...</a><br /></td></tr>
<tr class="separator:adc082a7212f9f61122a66418d18a6156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ed07aaa79d9a96bf22ce1afa21b6041"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#a4ed07aaa79d9a96bf22ce1afa21b6041">append</a> (uint8_t index, dtype value)</td></tr>
<tr class="memdesc:a4ed07aaa79d9a96bf22ce1afa21b6041"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds single element to the end of <code>this</code>  <a href="classbv_1_1branchless__scan.html#a4ed07aaa79d9a96bf22ce1afa21b6041">More...</a><br /></td></tr>
<tr class="separator:a4ed07aaa79d9a96bf22ce1afa21b6041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f59f804e16c1eb8d5621ef977cf15d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#a48f59f804e16c1eb8d5621ef977cf15d">prepend</a> (uint8_t n_elems, uint8_t array_size, uint8_t o_size, <a class="el" href="classbv_1_1branchless__scan.html">branchless_scan</a> *other)</td></tr>
<tr class="memdesc:a48f59f804e16c1eb8d5621ef977cf15d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds elements form <code>other</code> to the start of <code>this</code>  <a href="classbv_1_1branchless__scan.html#a48f59f804e16c1eb8d5621ef977cf15d">More...</a><br /></td></tr>
<tr class="separator:a48f59f804e16c1eb8d5621ef977cf15d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca4a78361d42756b5d7ad349c3640925"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#aca4a78361d42756b5d7ad349c3640925">find</a> (dtype q) const</td></tr>
<tr class="memdesc:aca4a78361d42756b5d7ad349c3640925"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the lowest child index s.t. the cumulative sum at the index is at least q.  <a href="classbv_1_1branchless__scan.html#aca4a78361d42756b5d7ad349c3640925">More...</a><br /></td></tr>
<tr class="separator:aca4a78361d42756b5d7ad349c3640925"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a82872402c47ed8eab5ec1b02effd89de"><td class="memItemLeft" align="right" valign="top">dtype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classbv_1_1branchless__scan.html#a82872402c47ed8eab5ec1b02effd89de">elems_</a> [branches]</td></tr>
<tr class="separator:a82872402c47ed8eab5ec1b02effd89de"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class dtype, dtype branches&gt;<br />
class bv::branchless_scan&lt; dtype, branches &gt;</h3>

<p>Class providing support for cumulative sums. </p>
<p>Supports maintaining cumulative sums for branching in internal nodes.</p>
<p>Querying is implemented as a branchless binary search using the sign bit for arithmetic instead of conditional moves.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">dtype</td><td>Integer type to use for indexing (uint32_t or uint64_t). </td></tr>
    <tr><td class="paramname">branches</td><td>Maximum branching factor of nodes. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="affab69f8448e7f3b1b064134c1af7247"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affab69f8448e7f3b1b064134c1af7247">&#9670;&nbsp;</a></span>branchless_scan()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::<a class="el" href="classbv_1_1branchless__scan.html">branchless_scan</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor creates an empty container for cumulative sums. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4ed07aaa79d9a96bf22ce1afa21b6041"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ed07aaa79d9a96bf22ce1afa21b6041">&#9670;&nbsp;</a></span>append() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::append </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dtype&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds single element to the end of <code>this</code> </p>
<p>Used when splitting root nodes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>Size of this. </td></tr>
    <tr><td class="paramname">value</td><td>Value to append. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adc082a7212f9f61122a66418d18a6156"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc082a7212f9f61122a66418d18a6156">&#9670;&nbsp;</a></span>append() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::append </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>n_elems</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>array_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbv_1_1branchless__scan.html">branchless_scan</a>&lt; dtype, branches &gt; *&#160;</td>
          <td class="paramname"><em>other</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds elements from <code>other</code> to the end of <code>this</code> </p>
<p>Intended for use when rebalancing. Adds <code>n_elemes</code> elements from <code>other</code> to the end of "these" cumulative sums. Should be subsequently removed from <code>other</code></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n_elems</td><td>Number of elements to append. </td></tr>
    <tr><td class="paramname">array_size</td><td>Number of elements stored in <code>this</code>. </td></tr>
    <tr><td class="paramname">other</td><td>Other cumulative size structure to copy from. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7d7cf39738cd42dceb5ef32feaa638d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d7cf39738cd42dceb5ef32feaa638d5">&#9670;&nbsp;</a></span>clear_first()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::clear_first </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>array_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes the first <code>n</code> elements from the structure. </p>
<p>Intended for use when rebalancing. A sibling has taken over some of the children and this is called to remove the moved children from the current node. Subsequent cumulative sums will be updated accordingly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of elements to remove. </td></tr>
    <tr><td class="paramname">array_size</td><td>Number of elements stored. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abc501318e710b909b638636e117854f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc501318e710b909b638636e117854f9">&#9670;&nbsp;</a></span>clear_last()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::clear_last </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>array_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes the last <code>n</code> elements from the structure. </p>
<p>Intended for use when rebalancing. A sibling has taken over some of the children and this is called to remove the moved children from the current node.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of elements to remove. </td></tr>
    <tr><td class="paramname">array_size</td><td>Number of elements stored. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aca4a78361d42756b5d7ad349c3640925"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca4a78361d42756b5d7ad349c3640925">&#9670;&nbsp;</a></span>find()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::find </td>
          <td>(</td>
          <td class="paramtype">dtype&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find the lowest child index s.t. the cumulative sum at the index is at least q. </p>
<p>This is implemented as a branchless binary search that uses the "sign
bit" for index manipulations instead of conditional moves. This is the reason for limiting the maximum data structure size to <code>(~dtype(0)) &gt;&gt; 1</code>.</p>
<p>If \(q &gt; \) <code>elems_[branches - 1]</code>, this will return either the index of the last child or the index following the last child. Either way, this will likely very quickly lead to undefined behaviour and segmentation fault.</p>
<p>If <code>elems_[branches - 1] &gt; (~(dtype(0)) &gt;&gt; 1</code>, querying is considered undefined behaviour.</p>
<p>This conditionally compiles the binary search based on acceptable branch factors. For low branching factors this is expected to be slightly slower than efficient vectorized linear searches. For higher branchin factors this branchless binary search should be faster as long as cache performance is good. Agressive prefetching is done in an attempt to ensure that cache misses don't occur during querying. See <a href="https://github.com/saskeli/search_microbench">https://github.com/saskeli/search_microbench</a> for a simple benchmark.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Query target </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>\(\underset{i}{\mathrm{arg min}}(\mathrm{cum\_sums}[i] \geq q)\). </dd></dl>

</div>
</div>
<a id="a563dc71ab583876c649b3cf885267d6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a563dc71ab583876c649b3cf885267d6c">&#9670;&nbsp;</a></span>get()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dtype <a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::get </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the cumulative sum at <code>index</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>Index to query. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Cumulative sum at <code>index</code>. </dd></dl>

</div>
</div>
<a id="a13e33906ab251c2664755eb0bf084c20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13e33906ab251c2664755eb0bf084c20">&#9670;&nbsp;</a></span>increment()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<div class="memtemplate">
template&lt;class T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::increment </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>array_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>change</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Increments all values in \([\mathrm{from}, \mathrm{array\_size})\) range. </p>
<p>Cumulative sums will always increment all subsequent values. Has to be passed as a parameter, since the value is not maintained by the <code>branch_selection</code> object.</p>
<p>The value may be negative or zero and will behave as expected.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Either a signer or unsigned integer type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">from</td><td>Start point of increment. </td></tr>
    <tr><td class="paramname">array_size</td><td>End point of increment (size of array). </td></tr>
    <tr><td class="paramname">change</td><td>Value to add ot each element in the range. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab2356610cf8948bbf29fa486264432f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2356610cf8948bbf29fa486264432f6">&#9670;&nbsp;</a></span>insert()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::insert </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>array_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dtype&#160;</td>
          <td class="paramname"><em>a_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dtype&#160;</td>
          <td class="paramname"><em>b_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Inserts a new value into the cumulative sums. </p>
<p>Intended for use when a new node is created between 2 exisiting nodes. Thus <code>index</code> is greater than 0 and less than <code>array_size</code>.</p>
<p>The cumulative sums of only 2 elements will be impacted since new "things" are not added. Rather some of the existing "things" are rebalanced, with the new element some of the "old" "things".</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>Position of new element. </td></tr>
    <tr><td class="paramname">array_size</td><td>Number of elements currently in the array. </td></tr>
    <tr><td class="paramname">a_value</td><td>Value of the left element. </td></tr>
    <tr><td class="paramname">b_value</td><td>Value of the right element. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a48f59f804e16c1eb8d5621ef977cf15d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48f59f804e16c1eb8d5621ef977cf15d">&#9670;&nbsp;</a></span>prepend()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::prepend </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>n_elems</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>array_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>o_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbv_1_1branchless__scan.html">branchless_scan</a>&lt; dtype, branches &gt; *&#160;</td>
          <td class="paramname"><em>other</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds elements form <code>other</code> to the start of <code>this</code> </p>
<p>Intended for use when rebalancing. Adds <code>n_elemes</code> elements from <code>other</code> to the start of "these" cumulative sums. Should be subsequently removed from <code>other</code></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n_elems</td><td>Number of elements to append. </td></tr>
    <tr><td class="paramname">array_size</td><td>Number of elements stored in <code>this</code>. </td></tr>
    <tr><td class="paramname">o_size</td><td>Number of elements stored in <code>other</code>. </td></tr>
    <tr><td class="paramname">other</td><td>Other cumulative size structure to copy from. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4df7fdfe653f38675f6fbe016bec8ef1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4df7fdfe653f38675f6fbe016bec8ef1">&#9670;&nbsp;</a></span>remove()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::remove </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>array_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes a value from the cumulative sums. </p>
<p>Intended for use when merging nodes.</p>
<p>Does not update the cumulative sums as it is expected that the elements in the removed node have been moved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>Position of element to remove. </td></tr>
    <tr><td class="paramname">array_size</td><td>Number of elements in the array. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab90a25b40c679751d980447f69250bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab90a25b40c679751d980447f69250bb9">&#9670;&nbsp;</a></span>set()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::set </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dtype&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the value at <code>index</code> to <code>value</code>. </p>
<p>Does no updating of internal sums or parameter validation.</p>
<p>A call to <code>get(i)</code> will return <code>v</code> after a <code>set(i, v)</code> call. All other values will remain unchanged.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>Index of value to modify. </td></tr>
    <tr><td class="paramname">value</td><td>New value to set. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a82872402c47ed8eab5ec1b02effd89de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82872402c47ed8eab5ec1b02effd89de">&#9670;&nbsp;</a></span>elems_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class dtype , dtype branches&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dtype <a class="el" href="classbv_1_1branchless__scan.html">bv::branchless_scan</a>&lt; dtype, branches &gt;::elems_[branches]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Underlying storage for cumulative sums. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>bit_vector/internal/<a class="el" href="branch__selection_8hpp_source.html">branch_selection.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Aug 24 2021 14:19:39 for Bit vector by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
