<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bit vector: bit_vector/internal/bit_vector.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bit vector
   &#160;<span id="projectnumber">0.9</span>
   </div>
   <div id="projectbrief">Fast and space efficient dynamic bit vector library.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_155b0d4b6b21b2b6c1f2d2152c1b3129.html">bit_vector</a></li><li class="navelem"><a class="el" href="dir_9de30e44f809b1527c464e5f0b53d68e.html">internal</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">bit_vector.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef BV_BIT_VECTOR_HPP</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define BV_BIT_VECTOR_HPP</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#ifndef WORD_BITS</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#define WORD_BITS 64</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">namespace </span><a class="code" href="bv_8hpp.html#a4b92c0a07b306636aec9f18892e47447">bv</a> {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class </span>leaf, <span class="keyword">class </span>node, <span class="keyword">class </span>allocator, uint64_t leaf_size,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;          uint8_t branches&gt;</div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html">   35</a></span>&#160;<span class="keyword">class </span><a class="code" href="classbv_1_1bit__vector.html">bit_vector</a> {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">   37</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a> = <span class="keyword">true</span>;      </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classbv_1_1bit__vector.html#ac2ec168e6e617653934fde38d5cd5f80">owned_allocator_</a> = <span class="keyword">false</span>;  </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="classbv_1_1node.html">node</a>* <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>;  </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="classbv_1_1leaf.html">leaf</a>* <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>;  </div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">   45</a></span>&#160;    allocator* <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>;  </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#a7aca131f67c823f8555e47a6d9f03198">   57</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classbv_1_1bit__vector.html#a7aca131f67c823f8555e47a6d9f03198">split_root</a>() {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="classbv_1_1node.html">node</a>* new_root = <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>-&gt;template allocate_node&lt;node&gt;();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="classbv_1_1node.html">node</a>* sibling = <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>-&gt;template allocate_node&lt;node&gt;();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#ab25112ec2200c74cb83b6feab93ef9a1">has_leaves</a>()) sibling-&gt;<a class="code" href="classbv_1_1node.html#ab25112ec2200c74cb83b6feab93ef9a1">has_leaves</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        sibling-&gt;<a class="code" href="classbv_1_1node.html#afd5c13dba4cac468ffc2513f55335dae">transfer_prepend</a>(<a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>, branches / 2);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        new_root-&gt;<a class="code" href="classbv_1_1node.html#a667820844114f3bb0004272dcc8c077b">append_child</a>(<a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        new_root-&gt;<a class="code" href="classbv_1_1node.html#a667820844114f3bb0004272dcc8c077b">append_child</a>(sibling);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a> = new_root;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   <span class="keyword">public</span>:</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#a1e2f45734a662544a1a6650bdb9b88bf">   78</a></span>&#160;    <a class="code" href="classbv_1_1bit__vector.html#a1e2f45734a662544a1a6650bdb9b88bf">bit_vector</a>(allocator* alloc) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a> = alloc;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a> =</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>-&gt;template allocate_leaf&lt;leaf&gt;(leaf_size / (2 * WORD_BITS));</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#ad2d298336cee72cbdecbc674146db9fe">   90</a></span>&#160;    <a class="code" href="classbv_1_1bit__vector.html#ad2d298336cee72cbdecbc674146db9fe">bit_vector</a>() {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a> = <span class="keyword">new</span> allocator();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="classbv_1_1bit__vector.html#ac2ec168e6e617653934fde38d5cd5f80">owned_allocator_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a> =</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>-&gt;template allocate_leaf&lt;leaf&gt;(leaf_size / (2 * WORD_BITS));</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#adee10cdadd2bed49dc0e18cdb153d725">  105</a></span>&#160;    <a class="code" href="classbv_1_1bit__vector.html#adee10cdadd2bed49dc0e18cdb153d725">~bit_vector</a>() {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a>) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>-&gt;deallocate_leaf(<a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#ae139057da6d7a5e248b321f3914468e6">deallocate</a>(<a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>-&gt;deallocate_node(<a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#ac2ec168e6e617653934fde38d5cd5f80">owned_allocator_</a>) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keyword">delete</span> (<a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#ae9cc8e6105e31ff528fc13209ad1f918">  133</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classbv_1_1bit__vector.html#ae9cc8e6105e31ff528fc13209ad1f918">insert</a>(uint64_t index, <span class="keywordtype">bool</span> value) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span> (index &gt; <a class="code" href="classbv_1_1bit__vector.html#ae9384d3b5a2dd385f2467d4d68647404">size</a>()) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            std::cerr &lt;&lt; <span class="stringliteral">&quot;Invalid insertion to index &quot;</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">&quot; for &quot;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                      &lt;&lt; <a class="code" href="classbv_1_1bit__vector.html#ae9384d3b5a2dd385f2467d4d68647404">size</a>() &lt;&lt; <span class="stringliteral">&quot; element bit vector.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            assert(index &lt;= <a class="code" href="classbv_1_1bit__vector.html#ae9384d3b5a2dd385f2467d4d68647404">size</a>());</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a>) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#a72b6cbe028c84fa34c1bbecec8adf56a">need_realloc</a>()) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#a80c498945e9cad87668936a6f23c71e8">size</a>() &gt;= leaf_size) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    <a class="code" href="classbv_1_1leaf.html">leaf</a>* sibling = <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>-&gt;template allocate_leaf&lt;leaf&gt;(</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                        leaf_size / (2 * WORD_BITS));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    sibling-&gt;<a class="code" href="classbv_1_1leaf.html#affaa678c11098f7b1df0ce42132a4cc8">transfer_append</a>(<a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>, leaf_size / 2);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                    <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a> = <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>-&gt;template allocate_node&lt;node&gt;();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#ab25112ec2200c74cb83b6feab93ef9a1">has_leaves</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                    <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#a667820844114f3bb0004272dcc8c077b">append_child</a>(sibling);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#a667820844114f3bb0004272dcc8c077b">append_child</a>(<a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                    <a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#acf15e749a6311c34ae62eaa4ad9ddfd9">insert</a>(index, value, <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    uint64_t cap = <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#ad9eafe86e48fe7ba0f0381520ac30531">capacity</a>();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a> =</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                        <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>-&gt;reallocate_leaf(<a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>, cap, cap + 2);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    [[likely]] <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#a381923edd5cf825653e30b47455d995d">insert</a>(index, value);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                [[likely]] <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#a381923edd5cf825653e30b47455d995d">insert</a>(index, value);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#ac847a9047faf8dfbd52b3a2b91197cf0">child_count</a>() == branches) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                [[unlikely]] <a class="code" href="classbv_1_1bit__vector.html#a7aca131f67c823f8555e47a6d9f03198">split_root</a>();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            [[likely]] <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#acf15e749a6311c34ae62eaa4ad9ddfd9">insert</a>(index, value, <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#a6ba7ad4c32302bab757fdd0efd48b790">  192</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classbv_1_1bit__vector.html#a6ba7ad4c32302bab757fdd0efd48b790">remove</a>(uint64_t index) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a>) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            [[unlikely]] <span class="keywordflow">return</span> <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#a70cac3c8e3fd04423245e6619d9c5fcc">remove</a>(index);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordtype">bool</span> v = <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#ada1ee834ac68d417cfcdfd18b098b98b">remove</a>(index, <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#ac847a9047faf8dfbd52b3a2b91197cf0">child_count</a>() == 1) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#ab25112ec2200c74cb83b6feab93ef9a1">has_leaves</a>()) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a> = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="classbv_1_1leaf.html">leaf</a>*<span class="keyword">&gt;</span>(<a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#a95404ba2d241e1621c305ec511026fce">child</a>(0));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                    <a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>-&gt;deallocate_node(<a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    <a class="code" href="classbv_1_1node.html">node</a>* new_root = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="classbv_1_1node.html">node</a>*<span class="keyword">&gt;</span>(<a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#a95404ba2d241e1621c305ec511026fce">child</a>(0));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>-&gt;deallocate_node(<a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a> = new_root;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                [[unlikely]] (void(0));</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">return</span> v;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#a3e711dbef3d646af5c75520bab276da7">  222</a></span>&#160;    uint64_t <a class="code" href="classbv_1_1bit__vector.html#a3e711dbef3d646af5c75520bab276da7">sum</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">return</span> !<a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a> ? <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#a3bf18e7fb6cd2f123b4ac9726dacdbee">p_sum</a>() : <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#a9f695cd17f566190c4478da07e489b45">p_sum</a>();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#ae9384d3b5a2dd385f2467d4d68647404">  234</a></span>&#160;    uint64_t <a class="code" href="classbv_1_1bit__vector.html#ae9384d3b5a2dd385f2467d4d68647404">size</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">return</span> !<a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a> ? <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#acbdfb951964fa5b8583178a79671e392">size</a>() : <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#a80c498945e9cad87668936a6f23c71e8">size</a>();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#a6a03a8dff701f9f32833cd8f208048bf">  256</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classbv_1_1bit__vector.html#a6a03a8dff701f9f32833cd8f208048bf">at</a>(uint64_t index)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">return</span> !<a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a> ? <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#ac704bf7b4d5ddfc2f150f9d73ee68bea">at</a>(index) : <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#af308d5eeb5d80e924ed180db52bb0ee2">at</a>(index);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#aa19f5f27141027ab7b889a1bd3f91b71">  274</a></span>&#160;    uint64_t <a class="code" href="classbv_1_1bit__vector.html#aa19f5f27141027ab7b889a1bd3f91b71">rank</a>(uint64_t index)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">return</span> !<a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a> ? <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#afe9c306d0befba0e1fca4d6178aaf6f0">rank</a>(index) : <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#abbffbd888e260cc0ec52ba7821294b09">rank</a>(index);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#a16c40fed84f9236d9f4fafd29cdce88c">  292</a></span>&#160;    uint64_t <a class="code" href="classbv_1_1bit__vector.html#a16c40fed84f9236d9f4fafd29cdce88c">select</a>(uint64_t count)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">return</span> !<a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a> ? <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#ab48b17e82e1a4a81aa80d6fd38991383">select</a>(count) : <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#aae36d25acec747b82fb12da32c347661">select</a>(count);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#ad694f865744adc813bd38523050eae91">  308</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classbv_1_1bit__vector.html#ad694f865744adc813bd38523050eae91">set</a>(uint64_t index, <span class="keywordtype">bool</span> value) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        !<a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a> ? <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#a2bf12280dae2634721d0d8d8206fee63">set</a>(index, value)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                       : <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#a19d80e6c67137a30ab9c31d5b3021101">set</a>(index, value);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#a45eb90409f956d1dc6ec9613f699c8fa">  324</a></span>&#160;    uint64_t <a class="code" href="classbv_1_1bit__vector.html#a45eb90409f956d1dc6ec9613f699c8fa">bit_size</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        uint64_t tree_size =</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a> ? <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#a7104583e1fed9975f0313b771cf78d07">bits_size</a>() : <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#ac8058dc416614319ee5c00c473dc8146">bits_size</a>();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">return</span> 8 * <span class="keyword">sizeof</span>(<a class="code" href="classbv_1_1bit__vector.html#ad2d298336cee72cbdecbc674146db9fe">bit_vector</a>) + tree_size;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#ae7af2a6b9adc0e9da7d0bdb30046174a">  344</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classbv_1_1bit__vector.html#ae7af2a6b9adc0e9da7d0bdb30046174a">validate</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#ac2ec168e6e617653934fde38d5cd5f80">owned_allocator_</a>) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            uint64_t allocs = <a class="code" href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">allocator_</a>-&gt;live_allocations();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a>) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                assert(allocs == <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#aa8a8696df9bdda57a46e824c79e24dcc">validate</a>());</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                assert(allocs == <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#af6f9dc1092d0dbac400e2eaa0787ae17">validate</a>());</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a>)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#aa8a8696df9bdda57a46e824c79e24dcc">validate</a>();</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#af6f9dc1092d0dbac400e2eaa0787ae17">validate</a>();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="classbv_1_1bit__vector.html#af45c40cbd94cb69b3d62dcde307fe92b">  366</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classbv_1_1bit__vector.html#af45c40cbd94cb69b3d62dcde307fe92b">print</a>(<span class="keywordtype">bool</span> internal_only)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <a class="code" href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">root_is_leaf_</a> ? <a class="code" href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">l_root_</a>-&gt;<a class="code" href="classbv_1_1leaf.html#a1f1766922dc590897519b4fb1c851430">print</a>(internal_only)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                      : <a class="code" href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">n_root_</a>-&gt;<a class="code" href="classbv_1_1node.html#a102f163e9ac6b0842c11ce624aa19642">print</a>(internal_only);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;};</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}  <span class="comment">// namespace bv</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassbv_1_1bit__vector_html_a6a03a8dff701f9f32833cd8f208048bf"><div class="ttname"><a href="classbv_1_1bit__vector.html#a6a03a8dff701f9f32833cd8f208048bf">bv::bit_vector::at</a></div><div class="ttdeci">bool at(uint64_t index) const</div><div class="ttdoc">Retrieves the value of the indexth element in the data structure.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:256</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_a3e711dbef3d646af5c75520bab276da7"><div class="ttname"><a href="classbv_1_1bit__vector.html#a3e711dbef3d646af5c75520bab276da7">bv::bit_vector::sum</a></div><div class="ttdeci">uint64_t sum() const</div><div class="ttdoc">Number of 1-bits in the data structure.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:222</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_abbffbd888e260cc0ec52ba7821294b09"><div class="ttname"><a href="classbv_1_1leaf.html#abbffbd888e260cc0ec52ba7821294b09">bv::leaf::rank</a></div><div class="ttdeci">uint64_t rank(const uint64_t n) const</div><div class="ttdoc">Number of 1-bits up to position n.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:325</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_a19d80e6c67137a30ab9c31d5b3021101"><div class="ttname"><a href="classbv_1_1leaf.html#a19d80e6c67137a30ab9c31d5b3021101">bv::leaf::set</a></div><div class="ttdeci">int set(const uint64_t i, const bool x)</div><div class="ttdoc">Set the ith bit to x.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:276</div></div>
<div class="ttc" id="aclassbv_1_1node_html_a2bf12280dae2634721d0d8d8206fee63"><div class="ttname"><a href="classbv_1_1node.html#a2bf12280dae2634721d0d8d8206fee63">bv::node::set</a></div><div class="ttdeci">int set(dtype index, bool v)</div><div class="ttdoc">Set the value of the logical indexth element to v.</div><div class="ttdef"><b>Definition:</b> node.hpp:157</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_a9f695cd17f566190c4478da07e489b45"><div class="ttname"><a href="classbv_1_1leaf.html#a9f695cd17f566190c4478da07e489b45">bv::leaf::p_sum</a></div><div class="ttdeci">uint64_t p_sum() const</div><div class="ttdoc">Getter for p_sum_.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:124</div></div>
<div class="ttc" id="aclassbv_1_1node_html_ae139057da6d7a5e248b321f3914468e6"><div class="ttname"><a href="classbv_1_1node.html#ae139057da6d7a5e248b321f3914468e6">bv::node::deallocate</a></div><div class="ttdeci">void deallocate(allocator *alloc)</div><div class="ttdoc">Recursively deallocates all children.</div><div class="ttdef"><b>Definition:</b> node.hpp:243</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_aa8a8696df9bdda57a46e824c79e24dcc"><div class="ttname"><a href="classbv_1_1leaf.html#aa8a8696df9bdda57a46e824c79e24dcc">bv::leaf::validate</a></div><div class="ttdeci">uint64_t validate() const</div><div class="ttdoc">Ensure that the leaf is in a valid state.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:877</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html"><div class="ttname"><a href="classbv_1_1bit__vector.html">bv::bit_vector</a></div><div class="ttdoc">Container class for dynamic b-tree bit vector stuctures.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:35</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_a8dd591415a14509f8be067e4a7b1465d"><div class="ttname"><a href="classbv_1_1bit__vector.html#a8dd591415a14509f8be067e4a7b1465d">bv::bit_vector::allocator_</a></div><div class="ttdeci">allocator * allocator_</div><div class="ttdoc">Pointer to allocator used for allocating internal nodes and leaves.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:45</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_a80c498945e9cad87668936a6f23c71e8"><div class="ttname"><a href="classbv_1_1leaf.html#a80c498945e9cad87668936a6f23c71e8">bv::leaf::size</a></div><div class="ttdeci">uint64_t size() const</div><div class="ttdoc">Getter for size_.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:126</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_affaa678c11098f7b1df0ce42132a4cc8"><div class="ttname"><a href="classbv_1_1leaf.html#affaa678c11098f7b1df0ce42132a4cc8">bv::leaf::transfer_append</a></div><div class="ttdeci">void transfer_append(leaf *other, uint64_t elems)</div><div class="ttdoc">Move &quot;elems&quot; elements from the start of &quot;other&quot; to the end of &quot;this&quot;.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:546</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_af308d5eeb5d80e924ed180db52bb0ee2"><div class="ttname"><a href="classbv_1_1leaf.html#af308d5eeb5d80e924ed180db52bb0ee2">bv::leaf::at</a></div><div class="ttdeci">bool at(const uint32_t i) const</div><div class="ttdoc">Get the value of the ith element in the leaf.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:101</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_ad694f865744adc813bd38523050eae91"><div class="ttname"><a href="classbv_1_1bit__vector.html#ad694f865744adc813bd38523050eae91">bv::bit_vector::set</a></div><div class="ttdeci">void set(uint64_t index, bool value)</div><div class="ttdoc">Sets the bit at &quot;index&quot; to &quot;value&quot;.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:308</div></div>
<div class="ttc" id="aclassbv_1_1node_html_afe9c306d0befba0e1fca4d6178aaf6f0"><div class="ttname"><a href="classbv_1_1node.html#afe9c306d0befba0e1fca4d6178aaf6f0">bv::node::rank</a></div><div class="ttdeci">dtype rank(dtype index) const</div><div class="ttdoc">Counts number of one bits up to the indexth logical element.</div><div class="ttdef"><b>Definition:</b> node.hpp:187</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_ae7af2a6b9adc0e9da7d0bdb30046174a"><div class="ttname"><a href="classbv_1_1bit__vector.html#ae7af2a6b9adc0e9da7d0bdb30046174a">bv::bit_vector::validate</a></div><div class="ttdeci">void validate() const</div><div class="ttdoc">Asserts that the data structure is internally consistent.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:344</div></div>
<div class="ttc" id="aclassbv_1_1node_html_a3bf18e7fb6cd2f123b4ac9726dacdbee"><div class="ttname"><a href="classbv_1_1node.html#a3bf18e7fb6cd2f123b4ac9726dacdbee">bv::node::p_sum</a></div><div class="ttdeci">dtype p_sum() const</div><div class="ttdoc">Logical number of 1-bits stored in the subtree.</div><div class="ttdef"><b>Definition:</b> node.hpp:308</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_af45c40cbd94cb69b3d62dcde307fe92b"><div class="ttname"><a href="classbv_1_1bit__vector.html#af45c40cbd94cb69b3d62dcde307fe92b">bv::bit_vector::print</a></div><div class="ttdeci">void print(bool internal_only) const</div><div class="ttdoc">Output data structure to standard out as json.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:366</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_ac2ec168e6e617653934fde38d5cd5f80"><div class="ttname"><a href="classbv_1_1bit__vector.html#ac2ec168e6e617653934fde38d5cd5f80">bv::bit_vector::owned_allocator_</a></div><div class="ttdeci">bool owned_allocator_</div><div class="ttdoc">True if deallocating the allocator is the responsibilty of the data structure.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:39</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_a1f1766922dc590897519b4fb1c851430"><div class="ttname"><a href="classbv_1_1leaf.html#a1f1766922dc590897519b4fb1c851430">bv::leaf::print</a></div><div class="ttdeci">void print(bool internal_only) const</div><div class="ttdoc">Output data stored in the leaf as json.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:904</div></div>
<div class="ttc" id="abv_8hpp_html_a4b92c0a07b306636aec9f18892e47447"><div class="ttname"><a href="bv_8hpp.html#a4b92c0a07b306636aec9f18892e47447">bv::bv</a></div><div class="ttdeci">simple_bv&lt; 8, 16384, 64 &gt; bv</div><div class="ttdoc">Default dynamic bit vector type.</div><div class="ttdef"><b>Definition:</b> bv.hpp:94</div></div>
<div class="ttc" id="aclassbv_1_1node_html_acf15e749a6311c34ae62eaa4ad9ddfd9"><div class="ttname"><a href="classbv_1_1node.html#acf15e749a6311c34ae62eaa4ad9ddfd9">bv::node::insert</a></div><div class="ttdeci">void insert(dtype index, bool value, allocator *alloc)</div><div class="ttdoc">Insert &quot;value&quot; at &quot;index&quot;.</div><div class="ttdef"><b>Definition:</b> node.hpp:360</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_a16c40fed84f9236d9f4fafd29cdce88c"><div class="ttname"><a href="classbv_1_1bit__vector.html#a16c40fed84f9236d9f4fafd29cdce88c">bv::bit_vector::select</a></div><div class="ttdeci">uint64_t select(uint64_t count) const</div><div class="ttdoc">Index of the countth 1-bit in the data structure.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:292</div></div>
<div class="ttc" id="aclassbv_1_1node_html_a667820844114f3bb0004272dcc8c077b"><div class="ttname"><a href="classbv_1_1node.html#a667820844114f3bb0004272dcc8c077b">bv::node::append_child</a></div><div class="ttdeci">void append_child(child *new_child)</div><div class="ttdoc">Add child to the subtree.</div><div class="ttdef"><b>Definition:</b> node.hpp:322</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_ad9eafe86e48fe7ba0f0381520ac30531"><div class="ttname"><a href="classbv_1_1leaf.html#ad9eafe86e48fe7ba0f0381520ac30531">bv::leaf::capacity</a></div><div class="ttdeci">uint32_t capacity() const</div><div class="ttdoc">Size of the leaf-associated data storage in 64-bit words.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:445</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_a393d84f94d09be134a6513898b460ba8"><div class="ttname"><a href="classbv_1_1bit__vector.html#a393d84f94d09be134a6513898b460ba8">bv::bit_vector::root_is_leaf_</a></div><div class="ttdeci">bool root_is_leaf_</div><div class="ttdoc">Value indicating whether the root is in n_root_ or l_root_.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:37</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html"><div class="ttname"><a href="classbv_1_1leaf.html">bv::leaf</a></div><div class="ttdoc">Simple flat dynamic bit vector for use as a leaf for a dynamic b-tree bit vector.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:47</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_a9a55b52ea39c46949a94e5ec963c3c5b"><div class="ttname"><a href="classbv_1_1bit__vector.html#a9a55b52ea39c46949a94e5ec963c3c5b">bv::bit_vector::l_root_</a></div><div class="ttdeci">leaf * l_root_</div><div class="ttdoc">Root if a single leaf is sufficient.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:44</div></div>
<div class="ttc" id="aclassbv_1_1node_html_a95404ba2d241e1621c305ec511026fce"><div class="ttname"><a href="classbv_1_1node.html#a95404ba2d241e1621c305ec511026fce">bv::node::child</a></div><div class="ttdeci">void * child(uint8_t i)</div><div class="ttdoc">Get ith child of the node.</div><div class="ttdef"><b>Definition:</b> node.hpp:344</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_a79b154fc6db039824594aa2122156d72"><div class="ttname"><a href="classbv_1_1bit__vector.html#a79b154fc6db039824594aa2122156d72">bv::bit_vector::n_root_</a></div><div class="ttdeci">node * n_root_</div><div class="ttdoc">Root of the b-tree if a multi-level structure is required.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:42</div></div>
<div class="ttc" id="aclassbv_1_1node_html_a102f163e9ac6b0842c11ce624aa19642"><div class="ttname"><a href="classbv_1_1node.html#a102f163e9ac6b0842c11ce624aa19642">bv::node::print</a></div><div class="ttdeci">void print(bool internal_only) const</div><div class="ttdoc">Outputs this subtree as json.</div><div class="ttdef"><b>Definition:</b> node.hpp:601</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_ad2d298336cee72cbdecbc674146db9fe"><div class="ttname"><a href="classbv_1_1bit__vector.html#ad2d298336cee72cbdecbc674146db9fe">bv::bit_vector::bit_vector</a></div><div class="ttdeci">bit_vector()</div><div class="ttdoc">Default constructor that creates an owned allocator.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:90</div></div>
<div class="ttc" id="aclassbv_1_1node_html_ab25112ec2200c74cb83b6feab93ef9a1"><div class="ttname"><a href="classbv_1_1node.html#ab25112ec2200c74cb83b6feab93ef9a1">bv::node::has_leaves</a></div><div class="ttdeci">void has_leaves(bool leaves)</div><div class="ttdoc">Set whether the children of the node are leaves or internal nodes.</div><div class="ttdef"><b>Definition:</b> node.hpp:114</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_a1e2f45734a662544a1a6650bdb9b88bf"><div class="ttname"><a href="classbv_1_1bit__vector.html#a1e2f45734a662544a1a6650bdb9b88bf">bv::bit_vector::bit_vector</a></div><div class="ttdeci">bit_vector(allocator *alloc)</div><div class="ttdoc">Bit vector constructor with existing allocator.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:78</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_a381923edd5cf825653e30b47455d995d"><div class="ttname"><a href="classbv_1_1leaf.html#a381923edd5cf825653e30b47455d995d">bv::leaf::insert</a></div><div class="ttdeci">void insert(const uint64_t i, const bool x)</div><div class="ttdoc">Insert x into position i.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:142</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_a70cac3c8e3fd04423245e6619d9c5fcc"><div class="ttname"><a href="classbv_1_1leaf.html#a70cac3c8e3fd04423245e6619d9c5fcc">bv::leaf::remove</a></div><div class="ttdeci">bool remove(const uint64_t i)</div><div class="ttdoc">Remove the ith bit from the leaf.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:209</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_ae9cc8e6105e31ff528fc13209ad1f918"><div class="ttname"><a href="classbv_1_1bit__vector.html#ae9cc8e6105e31ff528fc13209ad1f918">bv::bit_vector::insert</a></div><div class="ttdeci">void insert(uint64_t index, bool value)</div><div class="ttdoc">Insert &quot;value&quot; into position &quot;index&quot;.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:133</div></div>
<div class="ttc" id="aclassbv_1_1node_html_acbdfb951964fa5b8583178a79671e392"><div class="ttname"><a href="classbv_1_1node.html#acbdfb951964fa5b8583178a79671e392">bv::node::size</a></div><div class="ttdeci">dtype size() const</div><div class="ttdoc">Logical number of elements stored in the subtree.</div><div class="ttdef"><b>Definition:</b> node.hpp:299</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_a6ba7ad4c32302bab757fdd0efd48b790"><div class="ttname"><a href="classbv_1_1bit__vector.html#a6ba7ad4c32302bab757fdd0efd48b790">bv::bit_vector::remove</a></div><div class="ttdeci">bool remove(uint64_t index)</div><div class="ttdoc">Remove element at &quot;index&quot;.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:192</div></div>
<div class="ttc" id="aclassbv_1_1node_html_ada1ee834ac68d417cfcdfd18b098b98b"><div class="ttname"><a href="classbv_1_1node.html#ada1ee834ac68d417cfcdfd18b098b98b">bv::node::remove</a></div><div class="ttdeci">bool remove(dtype index, allocator *alloc)</div><div class="ttdoc">Remove the indexth element.</div><div class="ttdef"><b>Definition:</b> node.hpp:380</div></div>
<div class="ttc" id="aclassbv_1_1node_html_ab48b17e82e1a4a81aa80d6fd38991383"><div class="ttname"><a href="classbv_1_1node.html#ab48b17e82e1a4a81aa80d6fd38991383">bv::node::select</a></div><div class="ttdeci">dtype select(dtype count) const</div><div class="ttdoc">Calculates the index of the counttu 1-bit.</div><div class="ttdef"><b>Definition:</b> node.hpp:215</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_aa19f5f27141027ab7b889a1bd3f91b71"><div class="ttname"><a href="classbv_1_1bit__vector.html#aa19f5f27141027ab7b889a1bd3f91b71">bv::bit_vector::rank</a></div><div class="ttdeci">uint64_t rank(uint64_t index) const</div><div class="ttdoc">Number of 1-bits up to position index.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:274</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_a72b6cbe028c84fa34c1bbecec8adf56a"><div class="ttname"><a href="classbv_1_1leaf.html#a72b6cbe028c84fa34c1bbecec8adf56a">bv::leaf::need_realloc</a></div><div class="ttdeci">bool need_realloc() const</div><div class="ttdoc">Determine if reallocation / splitting is required prior to additional insertion of new elements.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:436</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_a7104583e1fed9975f0313b771cf78d07"><div class="ttname"><a href="classbv_1_1leaf.html#a7104583e1fed9975f0313b771cf78d07">bv::leaf::bits_size</a></div><div class="ttdeci">uint64_t bits_size() const</div><div class="ttdoc">Size of the leaf and associated data in bits.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:425</div></div>
<div class="ttc" id="aclassbv_1_1node_html_af6f9dc1092d0dbac400e2eaa0787ae17"><div class="ttname"><a href="classbv_1_1node.html#af6f9dc1092d0dbac400e2eaa0787ae17">bv::node::validate</a></div><div class="ttdeci">uint64_t validate() const</div><div class="ttdoc">Check that the subtree structure is internally consistent.</div><div class="ttdef"><b>Definition:</b> node.hpp:558</div></div>
<div class="ttc" id="aclassbv_1_1node_html"><div class="ttname"><a href="classbv_1_1node.html">bv::node</a></div><div class="ttdoc">Internal node for use with bit vector b-tree structures.</div><div class="ttdef"><b>Definition:</b> node.hpp:63</div></div>
<div class="ttc" id="aclassbv_1_1node_html_ac704bf7b4d5ddfc2f150f9d73ee68bea"><div class="ttname"><a href="classbv_1_1node.html#ac704bf7b4d5ddfc2f150f9d73ee68bea">bv::node::at</a></div><div class="ttdeci">bool at(dtype index) const</div><div class="ttdoc">Access the value of the indexth element of the logical structure.</div><div class="ttdef"><b>Definition:</b> node.hpp:133</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_ae9384d3b5a2dd385f2467d4d68647404"><div class="ttname"><a href="classbv_1_1bit__vector.html#ae9384d3b5a2dd385f2467d4d68647404">bv::bit_vector::size</a></div><div class="ttdeci">uint64_t size() const</div><div class="ttdoc">Number of elements stored in the data structure.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:234</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_a45eb90409f956d1dc6ec9613f699c8fa"><div class="ttname"><a href="classbv_1_1bit__vector.html#a45eb90409f956d1dc6ec9613f699c8fa">bv::bit_vector::bit_size</a></div><div class="ttdeci">uint64_t bit_size() const</div><div class="ttdoc">Total size of data structure allocations in bits.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:324</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_a7aca131f67c823f8555e47a6d9f03198"><div class="ttname"><a href="classbv_1_1bit__vector.html#a7aca131f67c823f8555e47a6d9f03198">bv::bit_vector::split_root</a></div><div class="ttdeci">void split_root()</div><div class="ttdoc">Increases the height of the tree by one level.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:57</div></div>
<div class="ttc" id="aclassbv_1_1node_html_ac8058dc416614319ee5c00c473dc8146"><div class="ttname"><a href="classbv_1_1node.html#ac8058dc416614319ee5c00c473dc8146">bv::node::bits_size</a></div><div class="ttdeci">uint64_t bits_size() const</div><div class="ttdoc">Size of the subtree in &quot;allocated&quot; bits.</div><div class="ttdef"><b>Definition:</b> node.hpp:520</div></div>
<div class="ttc" id="aclassbv_1_1node_html_afd5c13dba4cac468ffc2513f55335dae"><div class="ttname"><a href="classbv_1_1node.html#afd5c13dba4cac468ffc2513f55335dae">bv::node::transfer_prepend</a></div><div class="ttdeci">void transfer_prepend(node *other, uint8_t elems)</div><div class="ttdoc">Moves the last &quot;elems&quot; elements from &quot;other&quot; to the start of &quot;this&quot;.</div><div class="ttdef"><b>Definition:</b> node.hpp:467</div></div>
<div class="ttc" id="aclassbv_1_1leaf_html_aae36d25acec747b82fb12da32c347661"><div class="ttname"><a href="classbv_1_1leaf.html#aae36d25acec747b82fb12da32c347661">bv::leaf::select</a></div><div class="ttdeci">uint32_t select(const uint32_t x) const</div><div class="ttdoc">Index of the xth 1-bit in the data structure.</div><div class="ttdef"><b>Definition:</b> leaf.hpp:373</div></div>
<div class="ttc" id="aclassbv_1_1node_html_ac847a9047faf8dfbd52b3a2b91197cf0"><div class="ttname"><a href="classbv_1_1node.html#ac847a9047faf8dfbd52b3a2b91197cf0">bv::node::child_count</a></div><div class="ttdeci">uint8_t child_count() const</div><div class="ttdoc">Get the number of children of this node.</div><div class="ttdef"><b>Definition:</b> node.hpp:265</div></div>
<div class="ttc" id="aclassbv_1_1bit__vector_html_adee10cdadd2bed49dc0e18cdb153d725"><div class="ttname"><a href="classbv_1_1bit__vector.html#adee10cdadd2bed49dc0e18cdb153d725">bv::bit_vector::~bit_vector</a></div><div class="ttdeci">~bit_vector()</div><div class="ttdoc">Deconstructor that deallocates the entire data structure.</div><div class="ttdef"><b>Definition:</b> bit_vector.hpp:105</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 23 2021 14:50:53 for Bit vector by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
